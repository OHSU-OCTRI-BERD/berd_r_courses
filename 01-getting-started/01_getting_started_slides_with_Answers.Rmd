---
title: Getting Started with R and RStudio
author: Jessica Minnier, PhD & Meike Niederhausen, PhD
date: 'OHSU BERD Workshop <br><br> 2019/02/26 <br> Slides available at http://bit.ly/berd_r_intro'
output: 
  xaringan::moon_reader:
    css: [default, metropolis, metropolis-fonts]
    lib_dir: libs
    nature:
      highlightStyle: rainbow #http://arm.rbind.io/slides/xaringan.html#77
      highlightLines: true
      highlightLanguage: r
      countIncrementalSlides: false
    includes:
      in_header: ../header.html   
    #css: ../jminnier.css
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE)

library(tidyverse)

knitr::opts_chunk$set(
  warning=FALSE, 
  message=FALSE, 
  fig.width=10.5, 
  fig.height=4,
  fig.align = "center",
  rows.print=16,
  echo=TRUE,
  highlight = TRUE,
  prompt = TRUE, # IF TRUE adds a > before each code input
  comment=NA # PRINTS IN FRONT OF OUTPUT, default is '##' which comments out output
  #comment=NA
  )

theme_set(theme_bw(base_size = 24))
```


# Questions

- Who has used R?
- Why do you want to learn R?

---

# Learning Objectives

- Basic operations in R/RStudio
- Understand data structures
- Be able to load in data
- Basic operations on data
- Be able to make a plot
- Know how to get help

---
class: center, inverse, middle

# Introduction

Rrrrrr?

---

# What is R? 

.pull-left[
- A programming language
- Focus on statistical modeling and data analysis
    + import data, manipulate data, run statistics, make plots
- Useful for "Data Science"
- Great visualizations
- Also useful for most anything else you'd want to tell a computer to do
- Interfaces with other languages i.e. python, C++, bash

]


.pull-right[
![](img/R_logo.png)
]


For the history and details: [Wikipedia](https://bit.ly/1efFmaY)

- an interpreted language (run it through a command line)
- procedural programming with functions
- Why "R"?? Scheme (?) inspired S (invented at Bell Labs in 1976) which inspired R (**free and open source!** in 1993)



---

# What is RStudio?

![](img/01_md_rstudio.png)

- R is a programming language
- RStudio is an integrated development environment (IDE) = an interface to use R (with perks!)

from [Modern Dive](https://moderndive.com/2-getting-started.html); see also [DataCamp's video discussion on the difference](https://campus.datacamp.com/courses/working-with-the-rstudio-ide-part-1/orientation?ex=1)
---

# Start RStudio

![](img/01_md_r.png)

from [Modern Dive](https://moderndive.com/2-getting-started.html)

---

# RStudio anatomy

![](img/RStudio_Anatomy.svg)

---

# Show stuff

- tour of RStudio
- use console
- run some code
- make an R file and save it
- add some code

---

# Coding in the console 
 
.pull-left[
__Typing and execting code in the console __
* Type code in the console
* Press __return__ to execute the code

<br>

_Coding in the console is not advisable for most situations!_
* We only recommend this for short pieces of code that you don't need to save
]


.pull-right[
```{r}
7
3 + 5
"hello"

# this is a comment, nothing happens
# 5 - 8
```
]


---

# We can do math


.pull-left[
```{r}
10^2
3 ^ 7
6/9
9-43
```
]

--

.pull-right[
R follows the rules for order of operations and ignores spaces between numbers (or objects)

```{r}
4^3-2* 7+9 /2
```


The equation above is computed as $$4^3 âˆ’ (2 \cdot 7) + \frac{9}{2}$$ 
]


---

# Logarithms and exponentials

.pull-left[

Logarithms: `log()` is base $e$
```{r}
log(10)
log10(10)
```

]

--

.pull-right[
Exponentials
```{r}
exp(1)
exp(0)
```
]

<br>

--

Check that `log()` is base $e$

```{r}
log(exp(1))
```

---

# Variables

Data, information, everything is stored as a variable

* Can assign a variable using either `=` or `<-`
    - Using `<-` is preferable

.pull-left[
Assigning just one value:
```{r}
x = 5
x
x <- 5
x
```
]

--

.pull-right[
Assigning a __vector__ of values
* Consecutive integers

```{r}
a <- 3:10
a
```

* __Concatenate__ a string of numbers

```{r}
b <- c(5, 12, 2, 100, 8)
b
```
]


---

# We can do math with variables

.pull-left[
Math on variables with just one value
```{r}
x <- 5
x

x + 3

y <- x^2
y
```
]

--

.pull-right[
Math on vectors of values: element-wise computation
```{r}
a <- 3:6
a

a+2

a*3

a*a
```
]


---

# Variable can include text (characters)

```{r}
hi <- "hello"
hi

greetings <- c("Guten Tag", "Hola", hi)
greetings
```


---

# Common console errors 
 
__Incomplete commands__ 

.pull-left[
* When the console is waiting for a new command, the prompt line begins with `>`
  + If the console prompt is `+`, then a previous command is incomplete
  + You can finish typing the command in the console window
]
   
.pull-right[
Example:

```{r}
3 + (2*6
)
```
]

```{r error=TRUE, echo=FALSE}
# this is not a console example, since the console will prompt for more code with +
# 3 + (2*6
```

--

__Obejct is not found__

* This happens when text is entered for a non-existent variable (object)

Example:

```{r error=TRUE}
hello
```

---

# Coding in a script (1/3)

<!-- * Note that both of these options show the keyboard shortcut for your operating system   -->

* __Create a new script__ by 
    + selecting `File -> New File -> R Script`, 
    + or clicking on ![](img/01_Script_create.png) (the left most button at the top of the scripting window), and then selecting the first option `R Script` 

  
* __Type code__ in the script
    - Type each R command on its own line
    - Use `#` to convert text to comments so that text doesn't accidentally get executed as an R command

![](img/01_Scripting_practice1.png)
---

# Coding in a script (2/3)


* __Select code__ you want to execute, by 
    - placing the cursor in the line of code you want to execute, 
    - or highlighting the code you want to execute




* __Execute code__ in the script, by
    - clicking on the ![](img/01_Script_Run.png) button in the top right corner of the scripting window, 
    - or typing one of the following key combinations to execute the code
          + __Windows__:  __ctrl + r__
          + __Mac__:  __command + return__


![](img/01_Scripting_practice2.png)



---

# Coding in a script (3/3)

* The screenshot below shows code in the scripting window (top left window)
* The executed highlighted code and its output appear in the console window (bottom left window)

![](img/01_Scripting_practice3.png)


---

# Saving a script

* __Save a script__ by 
    + selecting `File -> Save`, 
    + or clicking on ![](img/01_Script_Save.png) (towards the left above the scripting window)

* You will need to specify
    + a __filename__ to save the script as
        - ALWAYS use __.R__ as the filename extension for R scripts
    + the __folder__ to save the script in

---

class: center, inverse, middle

# Practice time!

---

# Practice questions

1. Create a vector of all integers from 4 to 10, and save it as `a1`. 

2. Create a vector of _even_ integers from 4 to 10, and save it as `a2`. 

3. What is the sum of `a1` and `a2`? 

4. What does the command `sum(a1)` do?

5. What does the command `length(a1)` do?

6. Use the commands to calculate the average of the values in `a1`.

7. The formula for the first $n$ integers is $n(n+1)/2$. Compute the sum of all integers from 1 to 100 to verify that this formula holds for $n=100$. 

8. Compute the sum of the squares of all integers from 1 to 100.


---

# Answers to practice questions (1/4)

__#1__ Create a vector of all integers from 4 to 10, and save it as `a1`. 

__#2__ Create a vector of _even_ integers from 4 to 10, and save it as `a2`. 

```{r}
a1 <- 4:10
a2 <- c(4, 6, 8, 10)
```


__#3__ What is the sum of `a1` and `a2`? 

````{r warning=TRUE}
a1+a2
````

Note that instead of giving an error, the terms of `a1` are repeated as needed since `a2` is longer than `a1`


---

# Answers to practice questions (2/4)

__#4__ What does the command `sum(a1)` do?

```{r}
sum(a1)
```

`sum` adds up the values in the vector

<br>

__#5__ What does the command `length(a1)` do?

```{r}
length(a1)
```

`length` is the number of values in the vector

---

# Answers to practice questions (3/4)

__#6__ Use the commands to calculate the average of the values in `a1`.

```{r}
sum(a1) / length(a1)
```


__#7__ The formula for the first $n$ integers is $n(n+1)/2$. Compute the sum of all integers from 1 to 100 to verify that this formula holds for $n=100$. 

```{r}
sum(1:100)
# verify formula for n=100:
n=100
n * (n+1) / 2
```


---

# Answers to practice questions (4/4)

__#8__ Compute the sum of the squares of all integers from 1 to 100.

```{r}
# The following code creates a vector of the squares of all integers from 1 to 100
(1:100)^2

# Now add the squares:
sum((1:100)^2)
```




---

# Data frames

__Vectors__ vs. __data frames__: a data frame is a collection (or array or table) of vectors

```{r}
df <- data.frame(IDs=1:3, 
                 gender=c("male", "female", "Male"), 
                 age=c(28, 35.5, 31),
                 trt = c("control", "1", "1"),
                 Veteran = c(FALSE, TRUE, TRUE))
df
```



* A data frame allows different columns to be of different data types (i.e. numeric vs. text), and even allows both numeric and text within a column.

* Vectors and data frames are examples of what are more generally referred to as _objects_ in R. 
  + There are other types of R objects to sotre data, such as matrices, lists, and tibbles.
  + These will be discussed in future R workshops.


---

# Variable types

* integer: integer-valued numbers
* numeric: numbers that are decimals
* factor: how categorical variables are stored
* character: text 
* logical (TRUE, FALSE)

Each variable (column) in a data frame can be of a different type.

* View the __structure__ of our data frame to see what the variable types are:

```{r}
str(df)
```

<!-- * Note that the ID column is _integer_ type since the values are all whole numbers, although we likely would think of it as being a categorical variable and thus prefer it to be a factor. -->

---

# Data frame cells, rows, or columns


<!-- * Our data frame `df` -->

```{r}
df
```

Specific cell value: `DatSetName[row#, column#]`

```{r}
# Fourth row, Third column
df[2, 3]
```


.pull-left[
Entire column

```{r}
# Third column
df[, 3]
```
]

.pull-right[
Entire row
```{r}
# Second row
df[2,]
```
]




---

# Load a data set

* Open csv file directly from the internet:

```{r}
mydata <- read.csv(url("http://bit.ly/berd_data_csv"))
```

* Or, download file and open saved file using Import Dataset button in Environment window:  ![](img/01_Import_Dataset.png). 
  + If you use this option, then copy and paste the code from the console importing the data to your script so that you have a record of from where and how you loaded the data set.


```{r, eval=FALSE}
View(mydata) 
# Can also view the data by clicking on its name in the Environment tab
```


<!-- ![](img/01_View_data_screenshot.png) -->

<img src="img/01_View_data_screenshot.png" width="110%" height="110%">


---

# Data set summary

```{r}
summary(mydata)
```

---

# Data set info

```{r}
dim(mydata)
nrow(mydata)
ncol(mydata)

names(mydata)
```



---

# Data structure

* What are the differenct __variable types__ in this data set?


```{r}
str(mydata)   # structure of data
```


---

# View the beginning of a data set

```{r}
head(mydata)
head(mydata, 2)
```

---

# View the end of a data set

```{r}
tail(mydata)
```

---

# The $

Suppose we want to single out the column of BMI values.
* How did we previously learn to do this?

--

```{r}
mydata[, 6]
```

The problem with this method, is that we need to know the column number which can change as we make changes to the data set. 


* Use the `$` instead: `DatSetName$VariableName`

```{r}
mydata$bmi
```


---

# Basic plots of numeric data (1/3)


## Histogram

```{r fig.height=2.5, fig.width=7}
hist(mydata$bmi)
```

With extra features: 

```{r fig.height=2.5, fig.width=7}
hist(mydata$bmi, xlab = "BMI", main="BMI's of students")
```

---

# Basic plots of numeric data (2/3)

## Boxplot

.pull-left[
```{r fig.height=5, fig.width=5}
boxplot(mydata$bmi)
```

]

--

.pull-right[
```{r fig.height=5, fig.width=5}
boxplot(mydata$bmi ~ mydata$sex, 
  horizontal = TRUE, 
  xlab = "BMI", ylab = "sex",
  main = "BMI's of students by sex")
```
]

---

# Basic plots of numeric data (3/3)

## Scatterplot

.pull-left[
```{r fig.height=5, fig.width=5}
plot(mydata$weight, mydata$bmi)
```
]

.pull-right[
```{r fig.height=5, fig.width=5}
plot(mydata$weight, mydata$bmi, 
     xlab = "weight", ylab = "BMI", 
     main = 
       "BMI vs. Weight")
```
]

---

# Summary stats of numeric data (1/2)

## Standard R `summary` command

```{r}
summary(mydata$bmi)
```

## Mean and standard deviation

```{r}
mean(mydata$bmi)
sd(mydata$bmi)
```

---

# Summary stats of numeric data (2/2)
<!-- QQ: Why is (2/2) being cut off? It's not cut off for (1/2).-->
## Min, max, & median

.pull-left[
```{r}
min(mydata$bmi)
max(mydata$bmi)

```
]

.pull-right[
```{r}
median(mydata$bmi)
```
]

## Quantiles

```{r}
quantile(mydata$bmi, prob=c(0, .25, .5, .75, 1))  
```

---

# Add height column to data frame

Since $\textrm{BMI} = \frac{kg}{m^2}$, we have
$\textrm{height}(m) = \sqrt{\frac{\textrm{weight}(kg)}{\textrm{BMI}}}$

<!-- * UPDATE: need correct units! -->
```{r}
mydata$weight_kg <- mydata$weight  # UPDATE

mydata$height_m <- sqrt( mydata$weight_kg / mydata$bmi)
mydata$height_m
dim(mydata); names(mydata)
```


---

# Access specific columns in data set

.pull-left[
Previosuly we used `DatSetName[, column#]`

```{r}
mydata[, c(2, 6)]   # sixth column
```
]


.pull-right[
The code below uses _column names_ instead of numbers.

```{r}
mydata[, c("age", "bmi")]
```
]


<!-- This is the same as `mydata$bmi`. -->

---

# Access specific rows in data set


<!-- Below is code that uses the column names instead of row and column numbers. -->

* Rows for 14 year olds only
```{r}
mydata[mydata$age == "14 years old",]
```

In this case the output is only one row since there is only one 14 year old.

* Rows for teens with BMI less than 19
```{r}
mydata[mydata$bmi < 19,]
```

---

# Access specific values in data set 

* Grade and race for 15 year olds only

```{r}
mydata[mydata$age == "15 years old", c("grade", "race4")]
```


* Age, sex, and BMI for students with BMI less than 19

```{r}
mydata[mydata$bmi < 19, c("age", "sex", "bmi")]
```


---

# Practice

1. Create data frames for males and females separately.

2. Do males and females have similar BMI's? Weights? Compares means, standard deviations, range, and boxplots.

3. Plot BMI vs. weight for each gender separately. Do they have similar relationships?

4. Are males or females more likely to be bullied in the past 12 months? Calculate the percentage bullied for each gender.

5. Are students that were bullied in the past year more likely to have smoked in the past? Does this vary by gender?


---

# Practice Answers (1/7)

__#1__ Create data frames for males and females separately.

```{r}
boys <- mydata[mydata$sex == "Male", ]
girls <- mydata[mydata$sex == "Female", ]
```


---

# Practice Answers (2/7)

__#2__ Do males and females have similar BMI's? Weights? Compares means, standard deviations, range, and boxplots.

```{r}
summary(boys$bmi); sd(boys$bmi)
summary(girls$bmi); sd(girls$bmi)
```

---

# Practice Answers (3/7)

__#2__ cont'd

```{r fig.height=5}
boxplot(mydata$bmi ~ mydata$sex)
```


---

# Practice Answers (4/7)

__#3__ Plot BMI vs. weight for each gender separately. Do they have similar relationships?

.pull-left[
```{r fig.height=5, fig.width=4}
plot(boys$bmi, boys$weight)
```

]

.pull-right[

```{r fig.height=5, fig.width=4}
plot(girls$bmi, girls$weight)
```

]



---

# Practice Answers (5/7)

__#4__ Are males or females more likely to be bullied in the past 12 months? Calculate the percentage bullied for each gender.

```{r}
bullied_boys <- boys[boys$bullied_past_12mo == TRUE,]
nrow(bullied_boys)
bullied_boys_prct <- nrow(bullied_boys) / nrow(boys) * 100; bullied_boys_prct

bullied_girls <- girls[girls$bullied_past_12mo == TRUE,]
nrow(bullied_girls)
bullied_girls_prct <- nrow(bullied_girls) / nrow(girls) * 100; bullied_girls_prct
```


---

# Practice Answers (6/7)

__#5__ Are students that were bullied in the past year more likely to have smoked in the past? Does this vary by gender?

```{r}
bullied_yes <- mydata[mydata$bullied_past_12mo == TRUE,]
bullied_no <- mydata[mydata$bullied_past_12mo == FALSE,]

# Not bullied students have higher proportion of smokers
summary(bullied_yes$smoked_ever)
summary(bullied_no$smoked_ever)
```
 
---

# Practice Answers (7/7)

__#5__ cont'd

```{r}
# Vary by gender? Not really.
summary(bullied_yes[bullied_yes$sex == "Male", "smoked_ever"])
summary(bullied_yes[bullied_yes$sex == "Female", "smoked_ever"])

summary(bullied_no[bullied_no$sex == "Male", "smoked_ever"])
summary(bullied_no[bullied_no$sex == "Female", "smoked_ever"])
```

---

# Save data frame

* Save __.RData__ file: the standard R format, which is recommended if saving data for future use in R
```{r}
save(mydata, file = "mydata.RData")
```

You can load .RData files using the load() command:

```{r}
load("mydata.RData")
```
  

<br>

* Save __csv__ file: comma-separated values

```{r}
write.csv(mydata, file = "mydata.csv", col.names = TRUE, row.names = FALSE)
```


---

# Installing and using packages

Also can use the "Packages" tab in the Files/Plots/Packages/Help/Viewer window

## CRAN = package mothership

[Comprehensive R Archive Network](https://cran.r-project.org/)

```{r, eval = FALSE}
# Install a package from CRAN (main package repository)
install.packages("tidyverse")
# Load the package
library(tidyverse)
```

## Other places (i.e. github) = wild west

```{r, eval=FALSE}
install.packages("devtools")
library(devtools)
# Install a package from github (often in development, no testing)
# https://github.com/hadley/yrbss
install_github("hadley/yrbss")
library(yrbss)
```



---

# How to get help

---

# Resources

- [RStudio IDE Cheatsheet](https://resources.rstudio.com/rstudio-cheatsheets/rstudio-ide-cheat-sheet)
- Install R/RStudio [help video](https://www.youtube.com/watch?v=kOQDdJZ7Hl4&feature=youtu.be)
- [Basic Basics](http://rladiessydney.org/post/2018/11/05/basicbasics/)

Interactive lessons

- [DataCamp](www.datacamp.com)
    + [Introduction to R (free course)](https://www.datacamp.com/courses/free-introduction-to-r)
    + [Introduction to the Tidyverse](https://www.datacamp.com/courses/introduction-to-the-tidyverse)
    + [Intermediate R](https://www.datacamp.com/courses/intermediate-r)

Much of this is drawn from materials in online books/lessons:

- [Intro to R/RStudio](http://www-users.york.ac.uk/~er13/17C%20-%202018/pracs/01IntroductionToModuleAndRStudio.html) by Emma Rand
- [Modern Dive](https://moderndive.com/) - An Introduction to Statistical and Data Sciences via R by Chester Ismay & Albert Kim
- [Cookbook for R](http://www.cookbook-r.com/) by Winston Chang

---

# Possible Future Workshop Topics?

- data wrangling with the tidyverse
- reproducible reports in R
- tables
- ggplot2 visualization
- advanced tidyverse: functions, purrr
- statistical modeling in R


